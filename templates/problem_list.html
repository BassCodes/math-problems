{% extends "base.html" %}
{% block content %}

{% load markdown_extras %}
{% load static %}





<header>
    <h1 id="page-title">
       Problems
    </h1>
</header>


<div id="sidebar" class="left">
        <div id="sidebar-search">

            <div class="search-databox" data-type="source">
                <h2>Sources</h2>
                <ul id="chosen-filters">
                    {% for s in sources %}
                    {% if s.pk in sources_active %}
                    <li data-id="{{s.pk}}"  title="{{s.name}}"> 
                        <input type="checkbox" checked name="{{s.name}}" id="source{{s.pk}}">
                        <label for="source{{s.pk}}">
                            &Cross;
                            {% if s.shortname %}{{ s.get_short_name  }} 
                            {% else %}{{ s.name  }}
                            {% endif %}
                        </label>

                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
                <input type="search" name="" placeholder="Search Sources" id="">
                <ul id="available-filters">
                    {% for s in sources %}
                    {% if s.pk not in sources_active %}
                    <li data-id="{{s.pk}}"  title="{{s.name}}"> 
                        <input type="checkbox" name="{{s.name}}" id="source{{s.pk}}">
                        <label for="source{{s.pk}}">
                            &cup;
                            {% if s.shortname %}{{ s.get_short_name  }} 
                            {% else %}{{ s.name  }}
                            {% endif %}
                        </label>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>



            <div class="search-databox" data-type="category">
                <h2>Categories</h2>
                <ul id="chosen-filters">
                    {% for s in categories %}
                    {% if s.pk in categories_active %}
                    <li data-id="{{s.pk}}"  title="{{s.name}}"> 
                        <input type="checkbox" checked name="{{s.name}}" id="category{{s.pk}}">
                        <label for="category{{s.pk}}">
                            &Cross;
                            {{ s.name  }}
                        </label>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
                <input type="search" name="" placeholder="Search Categories" id="">
                <ul id="available-filters">
                    {% for s in categories %}
                    {% if s.pk not in categories_active %}
                    <li data-id="{{s.pk}}"  title="{{s.name}}"> 
                        <input type="checkbox" name="{{s.name}}" id="category{{s.pk}}">
                        <label for="category{{s.pk}}">
                            &cap;
                            {{ s.name  }}
                        </label>

                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
            <div class="search-databox" data-type="technique">
                <h2>Techniques</h2>
                <ul id="chosen-filters">
                    {% for s in techniques %}
                    {% if s.pk in techniques_active %}
                    <li data-id="{{s.pk}}"  title="{{s.name}}"> 
                        <input type="checkbox" checked name="{{s.name}}" id="technique{{s.pk}}">
                        <label for="technique{{s.pk}}">
                            &Cross;
                            {{ s.name  }}
                        </label>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
                <input type="search" name="" placeholder="Search Techniques" id="">
                <ul id="available-filters">
                    {% for s in techniques %}
                    {% if s.pk not in techniques_active %}
                    <li data-id="{{s.pk}}"  title="{{s.name}}"> 
                        <input type="checkbox" name="{{s.name}}" id="technique{{s.pk}}">
                        <label for="technique{{s.pk}}">
                            &cap;
                            {{ s.name  }}
                        </label>

                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>


        </div>
</div>

</div>

{% regroup problems by source as grouped_problems  %}


<main>
<div id="problem-list">
    {% for source,problem_group in grouped_problems %}
    
    <h2 id="source-name">
        {{ source.get_short_name }}
    </h2>
    
    <ol>
        {% for problem in problem_group %}
        <li value="{{problem.number}}" >
            <a href="{{problem.get_absolute_url}}">
                <span>
                    {{ problem.problem_text | markdown | safe}}
                </span>
            </a>
        </li>
        {% endfor %}
    </ol>
    {% empty %}
     <h2 class="muted">(No results found)</h2>
    {% endfor %}
</div>
</main>



{% endblock content %}

{% block pagehead %}
<script src="{% static 'problemlist.js' %}"></script>
<link rel="stylesheet" href="{% static 'problemlistsearch.css' %}">
<link rel="stylesheet" href="{% static 'problemlist.css' %}">
{% endblock pagehead %}